{"version":3,"sources":["base.js"],"names":["map","view","settings","ol","xs","xt","xl","ys","yt","yl","gridLayer","gridVector","geolocation","mapLayer","content","closer","overlay","markerLayers","days","0","1","2","3","4","5","6","roundCoords","coords","decimals","toFixed","updateUrl","url","window","location","host","$","val","user","grid","proj","transform","getCenter","Math","round","zoom","value","is","history","replaceState","closeDisclaimer","expiration_date","Date","setTime","getTime","cookie_string","now","toGMTString","document","cookie","greybox","close","addLiAlpha","ul","li","added","each","this","text","toLowerCase","insertBefore","appendTo","controls","show","duration","animate","left","borderBottomRightRadius","width","height","paddingLeft","hide","toggle","l","css","change","slider","doZoom","to","lat","lng","lvl","center","reset","homeGrid","point","what","home","set","init","marker","get","prop","layer","removeLayer","source","Vector","addFeature","Feature","geometry","geom","Point","style","Style","image","Icon","anchor","anchorXUnits","anchorYUnits","src","addLayer","getZoom","distance","dist","Sphere","haversineDistance","popover","coordinates","feature","geoName","getJSON","json","html","getGeometry","getCoordinates","addClass","name","grat","id","removeClass","x","toString","split","y","join","setPosition","undefined","isOpen","loadmap","Overlay","element","getElementById","autoPan","autoPanAnimation","click","blur","defaultZoom","View","minZoom","system","maxZoom","rotation","projection","Geolocation","getProjection","setTracking","on","getPosition","baseMaps","OSM","hyb","BingMaps","key","bingKey","imagerySet","sat","list","current","type","register","load","setVisible","baseMapLayer","newLayer","Tile","visible","push","baseMap","Group","layers","navigator","userAgent","match","renderer","resize","updateSize","Map","target","control","ScaleLine","Attribution","collapsible","interactions","interaction","defaults","rotate","altShiftDragRotate","pinchRotate","overlays","evt","forEachFeatureAtPixel","pixel","coordinate","hit","getTargetElement","cursor","open","box","data","attr","title","fadeIn","slideDown","scrollTop","slideUp","fadeOut","gcookie","setFullYear","getFullYear","single","dayOf","controlsVisible","resetSetHomeGrid","JSON","stringify","unset","alert","w30warning","date1","datepicker","date2","timeDiff","abs","diffDays","ceil","c","baseLat","floor","baseLng","latSign","lngSign","draw","length","drawLine","fill","Fill","color","weight","stroke","Stroke","points","i","LineString","curDate","date","force","keepPopover","Object","prototype","call","doDraw","getTimezoneOffset","day","getDay","getDate","bgColor","fgColor","s","west","parseFloat","east","global","refreshMaxDate","maxDate","setTimer","nextCheck","time","setTimeout","changeMonth","changeYear","dateFormat","showOtherMonths","selectOtherMonths","firstDay","minDate","altField","defaultDate","nextText","prevText","hideIfNoPrevNext","onSelect","min","max","slide","event","ui","hasClass","colorSet","stopPropagation","keyup","g","keyCode","which","niceScroll","showDisclaimer"],"mappings":"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","file":"map.min.js","sourcesContent":["/*\n * file:\t\tscript.js\n * author:\t\tMarten Tacoma\n * contents:\tall custom js\n */\n\nvar map, view, settings, ol, xs,xt,xl, ys,yt,yl, gridLayer, gridVector, geolocation, mapLayer, markerLayers = [], content, closer, overlay, days = {0:'Su', 1:'Mo', 2:'Tu', 3:'We', 4:'Th', 5:'Fr', 6:'Sa'};\n\nfunction roundCoords(coords, decimals){\n\treturn coords[1].toFixed(decimals)+','+coords[0].toFixed(decimals);\t\n}\n\nfunction updateUrl(){\n\tvar url = \"//\" + window.location.host\n\t\t+ '/t:' + $('input[name=map]:checked').val()\n\t\t+ '/' + $('#datepicker').val() \n\t\t+ '/g:' + roundCoords(settings.user.grid,1)\n\t\t+ '/c:' + roundCoords(ol.proj.transform(view.getCenter(), 'EPSG:3857', 'EPSG:4326'), 3)\n\t\t+ '/z:' + Math.round(zoom.value);\n\tif(!$('#showWeek').is(':checked')){\n\t\turl = url + '/s';\n\t}\n\twindow.history.replaceState({}, null, url);\n}\n\nfunction closeDisclaimer(){\n\tvar expiration_date = new Date();\n\texpiration_date.setTime(expiration_date.getTime()+(30*24*60*60*1000));\n\tvar cookie_string = \"disclaimer=\"+(Date.now() / 1000 | 0)+\";secure; path=/; expires=\" + expiration_date.toGMTString();\n\tdocument.cookie = cookie_string;\n\tgreybox.close();\n}\n\n//insert li at the right alphabetical place in an ul\nfunction addLiAlpha(ul, li){\n\tvar added = false;\n\t$(ul+\" li\").each(function(){\n\t\tif($(this).text().toLowerCase() > $(li).text().toLowerCase()){\n\t\t\t$(li).insertBefore($(this));\n\t\t\tadded = true;\n\t\t\treturn false;\n\t\t}\n\t});\n\tif(!added){\n\t\t$(li).appendTo($(ul));\n\t}\n}\n\nvar controls = {\n\tshow: function(duration){\n\t\t$('#controls').animate({left:'0px'},duration);\n\t\t$('#controlsTop').animate({left:'0px',borderBottomRightRadius:0},duration);\n\t\t$('.ol-scale-line').animate({left:'328px'},duration);\n\t\tif($(window).width() > 400 && $(window).height() > 400){\n\t\t\t$('#w30warning').animate({left:'320px',paddingLeft:'0px'});\n\t\t}\n\t},\n\thide: function(){\n\t\t$('#controls').animate({left:'-320px'});\n\t\t$('#controlsTop').animate({left:'-242px',borderBottomRightRadius:5});\n\t\t$('.ol-scale-line').animate({left:'8px'});\n\t\tif($(window).width() > 400 && $(window).height() > 400){\n\t\t\t$('#w30warning').animate({left:'0px',paddingLeft:'80px'});\n\t\t}\n\t},\n\ttoggle: function(){\n\t\tl = $('#controls').css('left');\n\t\tif(l === '0px'){\n\t\t\tcontrols.hide();\n\t\t} else if (l === '-320px') {\n\t\t\tcontrols.show();\n\t\t}\n\t}\n};\n\nvar zoom = {\n\tvalue: settings.user.zoom,\n\tchange: function(){\n\t\tzoom.value = $('#inputZoomLevel').val();\n\t\tupdateUrl();\n\t\t$('#zoomControl .slider').slider('value', zoom.value);\n\t\tzoom.doZoom(zoom.value);\n\t},\n\tdoZoom: function(value){\n\t\tview.animate({zoom: value, duration:500});\n\t},\n\tto: function(lat,lng,lvl){\n\t\tview.animate({zoom: lvl, center: ol.proj.transform([lng,lat], 'EPSG:4326', 'EPSG:3857'), duration:500});\n\t},\n\treset: function(){\n\t\tview.animate({zoom: settings.user.zoom, center: ol.proj.transform(settings.user.center, 'EPSG:4326', 'EPSG:3857'), duration:500});\n\t}\n};\n\nfunction homeGrid(point){\n\tvar what = $('input[name=setHomeGrid]:checked').val();\n\tvar point = ol.proj.transform(point, 'EPSG:3857', 'EPSG:4326');\n\tswitch(what){\n\t\tcase 'home':\n\t\t\thome.set(point);\n\t\t\tbreak;\n\t\tcase 'grid':\n\t\t\tgrid.init(point);\n\t\t\tmarker.get(true);\n\t\t\tbreak;\n\t\tcase 'both':\n\t\t\thome.set(point);\n\t\t\tgrid.init(point);\n\t\t\tmarker.get(true);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\t//do nothing\n\t}\n\tif($('#resetSetHomeGrid').is(':checked')){\n\t\t$('#setHomeGridNothing').prop('checked', true);\n\t}\n}\n\nvar home = {\n\tlayer: null,\n\tmarker: null,\n\tpoint: null,\n\tset: function(point){\n\t\tmap.removeLayer(home.layer);\n\t\twhile(point[0] > 180){\n\t\t\tpoint[0] -= 360;\n\t\t}\n\t\twhile(point[0] < -180){\n\t\t\tpoint[0] += 360;\n\t\t}\n\t\thome.point = point;\n\t\tsettings.user.home = point;\n\t\thome.marker = new ol.source.Vector({});\n\t\thome.marker.addFeature(new ol.Feature({geometry: new ol.geom.Point(ol.proj.transform(point, 'EPSG:4326', 'EPSG:3857'))}));\n\t\thome.layer = new ol.layer.Vector({\n\t\t\tsource: home.marker,\n\t\t\tstyle: new ol.style.Style({\n\t\t\t\timage: new ol.style.Icon({\n\t\t\t\t\tanchor: [16,16],\n\t\t\t\t\tanchorXUnits: 'pixels',\n\t\t\t\t\tanchorYUnits: 'pixels',\n\t\t\t\t\tsrc: '/img/marker.png'\n\t\t\t\t})\n\t\t\t})\n\t\t});\n\t\tmap.addLayer(home.layer);\n\t\tif(view.getZoom() === 2){\n\t\t\tzoom.to(point[1],point[0],settings.user.zoom);\n\t\t\tsettings.user.center = ol.proj.transform(view.getCenter(), 'EPSG:3857', 'EPSG:4326');\n\t\t}\n\t\tupdateUrl();\n\t},\n\tdistance: function(location){\n\t\tif(home.point == null){\n\t\t\treturn '';\n\t\t}\n\t\tvar wgs84Sphere = new ol.Sphere(6378137);\n\t\tvar dist = wgs84Sphere.haversineDistance(home.point,location)/1000;\n\t\treturn dist.toFixed(2) + ' km / ' +(dist*0.621371).toFixed(2) + ' miles<br/>';\n\t}\n};\n\npopover = {\n\tlat: null,\n\tlng: null,\n\tcoordinates: null,\n\tfeature: null,\n\tgeoName: function(){\n\t\t$.getJSON(\n\t\t\t'//data.geohashing.info/geoName/'+this.lat+'/'+this.lng,\n\t\t\tfunction(json){\n\t\t\t\t$('#geoName').html(json.geoName);\n\t\t\t}\n\t\t);\n\t},\n\tshow: function(feature){\n\t\tthis.feature = feature;\n\t\tthis.coordinates = ol.proj.transform(feature.getGeometry().getCoordinates(), 'EPSG:3857', 'EPSG:4326');\n\t\tthis.lng = this.coordinates[0];\n\t\tthis.lat = this.coordinates[1];\n\t\tthis.geoName();\n\t\tif(this.feature.get('global')){\n\t\t\t$('#popup').addClass('global');\n\t\t\tvar name = 'Globalhash ' + feature.get('date');\n\t\t\tvar grat = 'global';\n\t\t\tvar id = this.feature.get('date') + '_global';\n\t\t} else {\n\t\t\t$('#popup').removeClass('global');\n\t\t\tvar x = this.lng.toString().split('.')[0];\n\t\t\tvar y = this.lat.toString().split('.')[0];\n\t\t\tvar grat = y + ',' + x;\n\t\t\tvar name = 'Geohash ' + this.feature.get('date') + ' ' + y + ' ' + x;\n\t\t\tvar id = this.feature.get('date') + '_' + y + '_' + x;\n\t\t}\n\t\tcontent.html('<strong>'+name+'</strong> <button onclick=\"window.open(&quot;http://wiki.xkcd.com/geohashing/'+id+'&quot;)\">Meetup</button><br />'+\n\t\t\tthis.lat.toFixed(8) + ', ' + this.lng.toFixed(8) + ' <button onclick=\"zoom.to('+this.lat+','+this.lng+', 15)\">Zoom in</button><br />' +\n\t\t\t'<span id=\"geoName\"><span style=\"color:silver;font-style:italic\">[A location name should appear here]</span></span><br/>' +\n\t\t\thome.distance(this.coordinates) + \n\t\t\t'<button onclick=\"window.open(&quot;https://data.geohashing.info/hash/' + this.feature.get('date').split('-').join('/') + '/' + grat + '.gpx&quot;)\">GPX</button> <button onclick=\"window.open(&quot;http://geo.crox.net/poster/'+id+'&quot;)\">Poster</button> <button onclick=\"window.open(&quot;http://www.geocaching.com/seek/nearest.aspx?origin_lat='+this.lat+'&amp;origin_long='+this.lng+'&quot;)\">Nearby geocaches</button>'\n\t\t\t+ '<button onclick=\"window.open(&quot;https://maps.google.com/?q='+this.lat+','+this.lng+'&quot;)\">Google Maps</button>'\n\t\t\t+ ' <button onclick=\"window.open(&quot;https://geohashing.info/mobile/' + this.feature.get('date').split('-').join('/') + '/' + grat + '&quot;)\">Navigation compass</button> '\n\t\t\t);\n\t\toverlay.setPosition(this.feature.getGeometry().getCoordinates());\n\t},\n\thide: function(){\n\t\toverlay.setPosition(undefined);\n\t}\n};\n\nloadmap = function(){\n\tcontent = $('#popup-content');\n\tcloser = $('#popup-closer');\n\toverlay = new ol.Overlay({\n\t\telement: document.getElementById('popup'),\n\t\tautoPan: true,\n\t\tautoPanAnimation: {\n\t\t\tduration: 250\n\t\t}\n\t});\n\tcloser.click(function() {\n\t\toverlay.setPosition(undefined);\n\t\tcloser.blur();\n\t\treturn false;\n\t});\n\t\n\tvar defaultZoom = (settings.user.center != '0,0') ? settings.user.zoom : 2;\n\tview = new ol.View({\n\t\tcenter: ol.proj.transform(settings.user.center, 'EPSG:4326', 'EPSG:3857'),\n\t\tminZoom: settings.system.minZoom,\n\t\tzoom: defaultZoom,\n\t\tmaxZoom: settings.system.maxZoom,\n\t\trotation: 0,\n\t\tprojection: 'EPSG:3857'\n\t});\n\t\n\tgeolocation = new ol.Geolocation({\n\t\tprojection: view.getProjection()\n\t});\n\t\n\tif(settings.user.home == '0,0'){\n\t\tgeolocation.setTracking(true);\n\t\tif(settings.user.grid == '0,0'){\n\t\t\t$('#setHomeGridBoth').prop('checked', true);\n\t\t} else {\n\t\t\t$('#setHomeGridHome').prop('checked', true);\n\t\t}\n\t}\n\t\n\tgeolocation.on('change', function() {\n\t\thomeGrid(geolocation.getPosition());\n\t});\n\n\t//all available basemaps\n\tvar baseMaps = {\n\t\t'map': {\n\t\t\tsource: new ol.source.OSM(),\n\t\t\tname: 'OpenStreetMap'\n\t\t},\n\t\t'hyb': {\n\t\t\tsource : new ol.source.BingMaps({\n\t\t\t\tkey: settings.system.bingKey,\n\t\t\t\timagerySet: 'AerialWithLabels'\n\t\t\t}),\n\t\t\tname: 'Bing maps (Hybrid)'\n\t\t},\n\t\t'sat': {\n\t\t\tsource : new ol.source.BingMaps({\n\t\t\t\tkey: settings.system.bingKey,\n\t\t\t\timagerySet: 'Aerial'\n\t\t\t}),\n\t\t\tname: 'Bing maps (Satellite)'\n\t\t}\n\t};\n\tmapLayer = {\n\t\tlist: {},\n\t\tcurrent: settings.user.type,\n\t\tregister: function(id, layer, name) {\n\t\t\tthis.list[id] = layer;\n\t\t\taddLiAlpha('#mapControl', '<li onclick=\"javascript:mapLayer.load(\\'' + id + '\\')\"><input type=\"radio\" name=\"map\" value=\"' + id + '\" onchange=\"javascript:mapLayer.load(\\'' + id + '\\')\" id=\"map_' + id + '\" ' + ((this.current === id) ? 'checked=\"checked\"' : '') + '/> <label for=\"map_' + id + '\">' + name + '</label></li>');\n\t\t},\n\t\tload: function(id) {\n\t\t\tif (id !== this.current) {\n\t\t\t\tthis.list[id].setVisible(true); //show requested map\n\t\t\t\tthis.list[this.current].setVisible(false); //hide the visible map\n\t\t\t\tthis.current = id;\n\t\t\t\t$('#map_' + id).prop('checked', true);\n\t\t\t\tupdateUrl();\n\t\t\t}\n\t\t}\n\t};\n\n\tvar baseMapLayer = [];\n\tfor (var key in baseMaps) {\n\t\tvar newLayer = new ol.layer.Tile({\n\t\t\tsource: baseMaps[key].source,\n\t\t\tvisible: (mapLayer.current === key)\n\t\t});\n\t\tmapLayer.register(key, newLayer, baseMaps[key].name);\n\t\tbaseMapLayer.push(newLayer);\n\t}\n\t\n\tvar baseMap = new ol.layer.Group({\n\t\tlayers: baseMapLayer\n\t});\n\t\n\t//limit renderer when using twitter app on iOS (iPad, iPhone, iPod)\n\tif(navigator.userAgent.match(/Twitter for iP/i)){\n\t\trenderer = 'dom';\n\t\t$(window).resize(function(){\n\t\t\t$('#map').width($(window).width());\n\t\t\t$('#map').height($(window).height());\n\t\t\tmap.updateSize();\n\t\t});\n\t} else {\n\t\trenderer = ['canvas', 'dom', 'webgl'];\n\t}\n\tmap = new ol.Map({\n\t\ttarget: document.getElementById('map'),\n\t\tlayers: [ baseMap],\n\t\tview: view,\n\t\tcontrols: [\n\t\t\tnew ol.control.ScaleLine(),\n\t\t\tnew ol.control.Attribution({\n\t\t\t\tcollapsible: false\n\t\t\t})\n\t\t],\n\t\tinteractions: ol.interaction.defaults({\n\t\t\trotate: false,\n\t\t\taltShiftDragRotate: false,\n\t\t\tpinchRotate: false\n\t\t}),\n\t\toverlays: [overlay],\n\t\trenderer: renderer\n\t});\n\t\n\tmap.on('moveend', function(){\n\t\t$('#inputZoomLevel').val(view.getZoom());\n\t\tzoom.change();\n\t});\n\t\n\tmap.on('singleclick', function(evt) {\n\t\tvar feature = map.forEachFeatureAtPixel(evt.pixel, function(feature, layer){\n\t\t\treturn feature;\n\t\t});\n\t\tif(typeof feature !== 'undefined' && feature.get('date')){\n\t\t\tpopover.show(feature);\n\t\t} else {\n\t\t\thomeGrid(evt.coordinate);\n\t\t}\n\t});\n\t\n\tmap.on('pointermove', function(evt) {\n\t\tvar hit = map.forEachFeatureAtPixel(evt.pixel, function(feature, layer){\n\t\t\treturn feature.get('date');\n\t\t});\n\t\tmap.getTargetElement().style.cursor = hit ? 'pointer' : '';\n\t});\n};\n\nvar greybox = {\n\tisOpen: false,\n\topen: function(box){\n\t\t$.getJSON('/text/'+box, function(data){\n\t\t\t$('#greybox>div').attr('class', box);\n\t\t\t$('#greybox .title').html(data.title);\n\t\t\t$('#greybox .content').html(data.content);\n\t\t\t$(\"#greybox .content a[href^='http']\").attr('target','_blank');\n\t\t\t$('#greybox').fadeIn();\n\t\t\t$('#greybox div').slideDown();\n\t\t\t$('#greybox .content').scrollTop(0);\n\t\t\tgreybox.isOpen = true;\n\t\t});\n\t\treturn false;\n\t},\n\tclose: function(){\n\t\t$('#greybox>div').slideUp();\n\t\t$('#greybox').fadeOut();\n\t\t$('#greybox .closer').blur();\n\t\tgreybox.isOpen = false;\n\t}\n};\n\nvar gcookie = {\n\tset: function(){\n\t\t// Build the expiration date string:\n\t\tvar expiration_date = new Date();\n\t\tvar cookie_string = '';\n\t\texpiration_date.setFullYear(expiration_date.getFullYear() + 10);\n\t\t// Build the set-cookie string:\n\t\tsettings.user.center = ol.proj.transform(view.getCenter(), 'EPSG:3857', 'EPSG:4326');\n\t\tsettings.user.zoom = view.getZoom();\n\t\tsettings.user.single = !$('#showWeek').is(':checked'); \n\t\tsettings.user.dayOf = $('#dayOfWeek').is(':checked') ? 'week' : 'month';\n\t\tsettings.user.type = $('input[name=map]:checked').val();\n\t\tsettings.user.controlsVisible = $('#controlsVisible').is(':checked');\n\t\tsettings.user.resetSetHomeGrid = $('#resetSetHomeGrid').is(':checked');\n\t\tcookie_string = \"config=\"+JSON.stringify(settings.user)+\";secure; path=/; expires=\" + expiration_date.toGMTString();\n\t\t// Create/update the cookie:\n\t\tdocument.cookie = cookie_string;\n\t\tgreybox.open('settings');\n\t},\n\tunset: function(){\n\t\tcookie_string = \"config=;secure ;path=/; expires=Thu, 01 Jan 1970 00:00:01 GMT\";\n\t\tdocument.cookie = cookie_string;\n\t\twindow.alert('Your cookie is deleted');\n\t}\n};\n\nvar w30warning = {\n\ttoggle: function(){\n\t\tlng = settings.user.grid[0];\n\t\tif(lng < -29.0 || lng >= 179){\n\t\t\tvar date1 = new Date($('#dateControl .content.datepicker').datepicker('option', 'maxDate'));\n\t\t\tvar date2 = new Date($('#datepicker').val());\n\t\t\tvar timeDiff = Math.abs(date2.getTime() - date1.getTime());\n\t\t\tvar diffDays = Math.ceil(timeDiff / (1000 * 3600 * 24));\n\t\t\tif((diffDays === 0 || (diffDays < 7 && $('#showWeek').is(':checked')))){\n\t\t\t\tthis.show();\n\t\t\t} else {\n\t\t\t\tthis.hide();\n\t\t\t}\n\t\t} else {\n\t\t\tthis.hide();\n\t\t}\n\t},\n\tshow: function(){\n\t\t$('#w30warning .date').html($('#dateControl .content.datepicker').datepicker('option', 'maxDate'));\n\t\t$('#w30warning').fadeIn();\n\t},\n\thide: function(){\n\t\t$('#w30warning').fadeOut();\n\t},\n\treset: function(){\n\t\tif($(window).width() > 400 && $(window).height() > 400){\n\t\t\tl = $('#controls').css('left');\n\t\t\tif(l === '0px'){\n\t\t\t\t$('#w30warning').css('left', '320px');\n\t\t\t\t$('#w30warning').css('padding-left', '0px');\n\t\t\t} else if (l === '-320px') {\n\t\t\t\t$('#w30warning').css('left', '0px');\n\t\t\t\t$('#w30warning').css('padding-left', '80px');\n\t\t\t}\n\t\t} else {\n\t\t\t$('#w30warning').css('left', '');\n\t\t\t$('#w30warning').css('padding-left', '');\n\t\t}\n\t}\n};\n"]}