function initCompass(){Compass.needGPS(function(){$("#compass").html("<br/>GPS signal needed to get compass direction")}).needMove(function(){$("#compass").html("<br/>Please move to get orientation")}).init(function(){$("#compass").html('<br/><div id="arrow"><div></div></div>'),getHash(),watchL=setInterval(doWatch,1e3),watchC=Compass.watch(function(a){deviceHeading=a,setCompass()})})}function getHash(){$.getJSON("//data.geohashing.info/hash/"+date+"/"+graticule+".json",function(a){hash=LatLon(a.lat,a.lng)})}function getLocation(){var a={enableHighAccuracy:!0,timeout:5e3,maximumAge:0};navigator.geolocation.getCurrentPosition(function(a){loc=LatLon(a.coords.latitude,a.coords.longitude),$("#accuracy").text(a.coords.accuracy+" m"),accuracy=a.coords.accuracy.toFixed(0),accuracy>maxAccuracy?$("#accuracy").addClass("low"):$("#accuracy").removeClass("low")},function(){},a)}function setCompass(){heading=360-deviceHeading+bearing,$("#arrow").css("-moz-transform","rotate("+heading+"deg)"),$("#arrow").css("-webkit-transform","rotate("+heading+"deg)"),$("#arrow").css("-o-transform","rotate("+heading+"deg)"),$("#arrow").css("-ms-transform","rotate("+heading+"deg)")}function doWatch(){if(getLocation(),null!==hash&&null!==loc)if($("#compass").show(),dist=loc.distanceTo(hash),unit="m",dist>9999&&(dist/=1e3,unit="km"),$("#distance").text(dist.toFixed(2)+" "+unit),bearing=loc.bearingTo(hash),dist<accuracy&&accuracy<maxAccuracy){$("#compass").addClass("reached"),$("#status").show();var a=new Date;$("#status").html("<h2>Congratulations!</h2><p>You have reached the<br/><br/><strong>"+date+" "+graticule+"</strong><br/><br/> hash on</p><p>"+a.toLocaleString()+"</p>")}else $("#compass").removeClass("reached"),$("#status").hide()}var maxAccuracy=100,watchL,watchC;$(function(){"geolocation"in navigator?(functional=!0,Compass.noSupport(function(){$("#compass").html('<br/>Compass is not available on your device.<br/><br/>You can use the QR code to open this page on your mobile.<br/><img src="https://chart.googleapis.com/chart?chs=300x300&cht=qr&chl=https://geohashing.info/mobile/'+date+"/"+graticule+'&choe=UTF-8" />'),functional=!1}),functional&&initCompass()):$("#compass").html("<br/>Geolocation is not available on your device")});var hash=null,loc=null,deviceHeading=0,bearing=0,accuracy=999;